backend/
‚îú‚îÄ‚îÄ server.js:
import express from "express";
import cors from "cors";
import bodyParser from "body-parser";
import dotenv from "dotenv";
import connectDB from "./config/db.js";
import dataRoutes from "./routes/dataRoutes.js";
import userRoutes from "./routes/userRoutes.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 5000;

// Middleware
app.use(cors());
app.use(bodyParser.json());

// Database connection
connectDB();

// Default route
app.get("/", (req, res) => {
  res.send("üöÄ Urban Growth Backend is running successfully!");
});

// API Routes
app.use("/api/data", dataRoutes);
app.use("/api/users", userRoutes);

// Sample data endpoint for frontend testing
app.get("/api/sample-data", (req, res) => {
  const sampleCities = [
    { city: "Metropolis", population: "2,300,000", density: "4,500/km¬≤", growth: "12.5%", pollutionLevel: "Medium" },
    { city: "Tech Valley", population: "1,800,000", density: "3,200/km¬≤", growth: "18.2%", pollutionLevel: "Low" },
    { city: "Green Haven", population: "950,000", density: "2,100/km¬≤", growth: "8.7%", pollutionLevel: "Low" },
    { city: "Industrial City", population: "3,100,000", density: "5,800/km¬≤", growth: "5.3%", pollutionLevel: "High" },
    { city: "Coastal Bay", population: "1,200,000", density: "1,800/km¬≤", growth: "15.8%", pollutionLevel: "Medium" },
    { city: "Mountain View", population: "680,000", density: "1,200/km¬≤", growth: "22.1%", pollutionLevel: "Low" }
  ];
  res.json(sampleCities);
});

// AI prediction simulation
app.post("/api/predict", (req, res) => {
  const { username } = req.body;
  const predictionResult = Math.random() > 0.5 ? "Secure" : "Not Secure";

  res.json({
    message: "Prediction successful",
    username,
    output: predictionResult,
  });
});

app.listen(PORT, () => {
  console.log(`üåç Server running on http://localhost:${PORT}`);
});
‚îú‚îÄ‚îÄ package.json:
{
  "name": "backend",
  "version": "1.0.0",
  "type": "module",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bcryptjs": "^3.0.2",
    "body-parser": "^2.2.0",
    "cors": "^2.8.5",
    "dotenv": "^17.2.3",
    "express": "^5.1.0",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.19.1"
  },
  "devDependencies": {
    "nodemon": "^3.1.10"
  },
  "description": ""
}

‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ config/
‚îÇ ‚îî‚îÄ‚îÄ db.js:
import mongoose from "mongoose";

const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI);
    console.log("‚úÖ MongoDB Connected Successfully");
  } catch (error) {
    console.error("‚ùå Database connection failed:", error.message);
    process.exit(1);
  }
};

export default connectDB;
‚îú‚îÄ‚îÄ models/
‚îÇ ‚îú‚îÄ‚îÄ userModel.js:
import mongoose from "mongoose";

const userSchema = new mongoose.Schema({
  username: { type: String, required: true, unique: true },
  password: { type: String, required: true },
});

export default mongoose.model("User", userSchema);

‚îÇ ‚îî‚îÄ‚îÄ dataModel.js:
import mongoose from "mongoose";

const dataSchema = new mongoose.Schema({
  username: { type: String, required: true },
  analysisResult: { type: String, required: true },
  pollutionLevel: { type: String, enum: ['Low', 'Medium', 'High'], default: 'Medium' },
  city: { type: String, required: true },
  population: { type: String },
  density: { type: String },
  growth: { type: String },
  urbanData: {
    greenSpaces: { type: Number },
    trafficIndex: { type: Number },
    housingIndex: { type: Number },
    employmentRate: { type: Number }
  },
  createdAt: { type: Date, default: Date.now }
});

const Data = mongoose.model("Data", dataSchema);
export default Data;
‚îú‚îÄ‚îÄ controllers/
‚îÇ ‚îú‚îÄ‚îÄ userController.js:
import User from "../models/userModel.js";
import Data from "../models/dataModel.js";
import bcrypt from "bcryptjs";
import jwt from "jsonwebtoken";

// ‚úÖ Register User
export const registerUser = async (req, res) => {
  try {
    const { username, password } = req.body;

    console.log("üìù Registration attempt for username:", username);

    // Validation
    if (!username || !password) {
      return res.status(400).json({ 
        success: false,
        message: "All fields are required" 
      });
    }

    // Check for existing user (case-insensitive)
    const existingUser = await User.findOne({
      username: { $regex: new RegExp("^" + username + "$", "i") }
    });

    console.log("üîç Existing user check result:", existingUser);

    if (existingUser) {
      console.log("‚ùå User already exists in database");
      return res.status(400).json({ 
        success: false,
        message: "Username already exists. Please choose a different username.",
        debug: {
          requestedUsername: username,
          existingUsername: existingUser.username
        }
      });
    }

    // Hash password
    const hashedPassword = await bcrypt.hash(password, 10);

    // Create user
    const newUser = await User.create({
      username,
      password: hashedPassword
    });

    console.log("‚úÖ New user created:", newUser.username);

    // Generate token with username included
    const token = jwt.sign({ 
      id: newUser._id, 
      username: newUser.username 
    }, process.env.JWT_SECRET, {
      expiresIn: "1h"
    });

    // Auto-save registration event
    try {
      const registrationData = new Data({
        username: newUser.username,
        analysisResult: "User registered successfully",
        actionType: "login",
        city: "System",
        createdAt: new Date(),
      });
      await registrationData.save();
      console.log("‚úÖ Registration event saved to database");
    } catch (saveError) {
      console.error("‚ùå Failed to save registration event:", saveError);
    }

    res.status(201).json({
      success: true,
      message: "User registered successfully",
      user: { id: newUser._id, username: newUser.username },
      token
    });
  } catch (error) {
    console.error("‚ùå Registration Error:", error);
    res.status(500).json({ 
      success: false,
      message: "Error registering user", 
      error: error.message 
    });
  }
};

// ‚úÖ Login User
export const loginUser = async (req, res) => {
  try {
    const { username, password } = req.body;

    if (!username || !password)
      return res.status(400).json({ 
        success: false,
        message: "All fields are required" 
      });

    const user = await User.findOne({ username });
    if (!user)
      return res.status(400).json({ 
        success: false,
        message: "User not found" 
      });

    const isMatch = await bcrypt.compare(password, user.password);
    if (!isMatch)
      return res.status(400).json({ 
        success: false,
        message: "Invalid credentials" 
      });

    // Generate token with username included
    const token = jwt.sign({ 
      id: user._id, 
      username: user.username 
    }, process.env.JWT_SECRET, {
      expiresIn: "1h"
    });

    // Auto-save login event
    try {
      const loginData = new Data({
        username: user.username,
        analysisResult: "User logged in successfully",
        actionType: "login",
        city: "System",
        createdAt: new Date(),
      });
      await loginData.save();
      console.log("‚úÖ Login event saved to database");
    } catch (saveError) {
      console.error("‚ùå Failed to save login event:", saveError);
    }

    res.json({
      success: true,
      message: "Login successful",
      token,
      user: { id: user._id, username: user.username }
    });
  } catch (error) {
    console.error("‚ùå Login Error:", error);
    res.status(500).json({ 
      success: false,
      message: "Login error", 
      error: error.message 
    });
  }
};
‚îÇ ‚îî‚îÄ‚îÄ dataController.js:
import Data from "../models/dataModel.js";

// ‚úÖ Save data to MongoDB
export const saveData = async (req, res) => {
  try {
    const {
      username,
      analysisResult,
      pollutionLevel,
      city,
      population,
      density,
      growth,
      urbanData,
    } = req.body;

    const newData = new Data({
      username,
      analysisResult,
      pollutionLevel: pollutionLevel || "Medium",
      city: city || "Unknown City",
      population,
      density,
      growth,
      urbanData,
      createdAt: new Date(),
    });

    await newData.save();
    res.status(201).json({
      message: "‚úÖ Data saved successfully!",
      data: newData,
    });
  } catch (error) {
    res.status(500).json({
      message: "‚ùå Error saving data",
      error: error.message,
    });
  }
};

// ‚úÖ Retrieve all stored data
export const getData = async (req, res) => {
  try {
    const data = await Data.find().sort({ createdAt: -1 });
    res.status(200).json({
      message: "‚úÖ Data fetched successfully!",
      data,
    });
  } catch (error) {
    res.status(500).json({
      message: "‚ùå Error retrieving data",
      error: error.message,
    });
  }
};

// ‚úÖ Get basic analytics (optional summary)
export const getUrbanAnalytics = async (req, res) => {
  try {
    const analytics = await Data.aggregate([
      {
        $group: {
          _id: "$city",
          totalRecords: { $sum: 1 },
          avgPollution: {
            $avg: {
              $switch: {
                branches: [
                  { case: { $eq: ["$pollutionLevel", "Low"] }, then: 1 },
                  { case: { $eq: ["$pollutionLevel", "Medium"] }, then: 2 },
                  { case: { $eq: ["$pollutionLevel", "High"] }, then: 3 },
                ],
                default: 2,
              },
            },
          },
        },
      },
    ]);

    res.status(200).json({
      message: "‚úÖ Urban analytics generated!",
      analytics,
    });
  } catch (error) {
    res.status(500).json({
      message: "‚ùå Error generating analytics",
      error: error.message,
    });
  }
};

‚îú‚îÄ‚îÄ routes/
‚îÇ ‚îú‚îÄ‚îÄ userRoutes.js:
import express from "express";
import { registerUser, loginUser } from "../controllers/userController.js";

const router = express.Router();

router.post("/register", registerUser);
router.post("/login", loginUser);

export default router;

‚îÇ ‚îî‚îÄ‚îÄ dataRoutes.js:
import express from "express";
import {
  saveData,
  getData,
  getUrbanAnalytics
} from "../controllers/dataController.js";
import { verifyToken } from "../middleware/authMiddleware.js";

const router = express.Router();

// ‚úÖ Protected routes (accessible only with valid JWT token)
router.post("/", verifyToken, saveData);
router.get("/", verifyToken, getData);
router.get("/analytics", verifyToken, getUrbanAnalytics);

export default router;

‚îî‚îÄ‚îÄ middleware/
‚îî‚îÄ‚îÄ authMiddleware.js:
import jwt from "jsonwebtoken";

export const verifyToken = (req, res, next) => {
  const authHeader = req.headers.authorization;

  if (!authHeader || !authHeader.startsWith("Bearer ")) {
    return res.status(401).json({ message: "‚ùå Access denied. No token provided." });
  }

  const token = authHeader.split(" ")[1];

  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next(); // ‚úÖ Continue to controller
  } catch (error) {
    console.error("‚ùå Token Verification Error:", error);
    res.status(403).json({ message: "‚ùå Invalid or expired token." });
  }
};
frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ App.jsx:
import { BrowserRouter as Router, Routes, Route, Navigate } from "react-router-dom";
import Navbar from "./components/Navbar";
import Footer from "./components/Footer";
import Sidebar from "./components/Sidebar";
import Login from "./pages/Login";
import Register from "./pages/Register";
import Dashboard from "./pages/Dashboard";
import Reports from "./pages/Reports";
import ProtectedRoute from "./components/ProtectedRoute";

function App() {
  return (
    <Router>
      <div className="min-h-screen flex flex-col gradient-bg">
        <Routes>
          {/* Redirect root to login */}
          <Route path="/" element={<Navigate to="/login" replace />} />
          
          {/* Login page - show navbar */}
          <Route path="/login" element={
            <>
              <Navbar />
              <Login />
            </>
          } />
          
          {/* Register page - show navbar */}
          <Route path="/register" element={
            <>
              <Navbar />
              <Register />
            </>
          } />
          
          {/* Protected routes - no navbar (they have sidebar) */}
          <Route path="/dashboard" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <Dashboard />
              </div>
            </ProtectedRoute>
          } />
          
          <Route path="/reports" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <Reports />
              </div>
            </ProtectedRoute>
          } />
          
          {/* Other protected routes */}
          <Route path="/population" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <div className="flex-1 p-8 bg-gray-50">
                  <h1 className="text-3xl font-bold text-gray-900">Population Analytics</h1>
                  <p className="text-gray-600">Detailed population metrics and demographics coming soon...</p>
                </div>
              </div>
            </ProtectedRoute>
          } />
          
          <Route path="/infrastructure" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <div className="flex-1 p-8 bg-gray-50">
                  <h1 className="text-3xl font-bold text-gray-900">Infrastructure Analytics</h1>
                  <p className="text-gray-600">Urban infrastructure insights coming soon...</p>
                </div>
              </div>
            </ProtectedRoute>
          } />
          
          <Route path="/environment" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <div className="flex-1 p-8 bg-gray-50">
                  <h1 className="text-3xl font-bold text-gray-900">Environmental Analytics</h1>
                  <p className="text-gray-600">Sustainability and environmental data coming soon...</p>
                </div>
              </div>
            </ProtectedRoute>
          } />
          
          <Route path="/transport" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <div className="flex-1 p-8 bg-gray-50">
                  <h1 className="text-3xl font-bold text-gray-900">Transport Analytics</h1>
                  <p className="text-gray-600">Transportation and mobility data coming soon...</p>
                </div>
              </div>
            </ProtectedRoute>
          } />
          
          <Route path="/settings" element={
            <ProtectedRoute>
              <div className="flex min-h-screen">
                <Sidebar />
                <div className="flex-1 p-8 bg-gray-50">
                  <h1 className="text-3xl font-bold text-gray-900">Settings</h1>
                  <p className="text-gray-600">System configuration coming soon...</p>
                </div>
              </div>
            </ProtectedRoute>
          } />
          
          {/* Catch all route - redirect to login */}
          <Route path="*" element={<Navigate to="/login" replace />} />
        </Routes>
        <Footer />
      </div>
    </Router>
  );
}

export default App;
‚îÇ   ‚îú‚îÄ‚îÄ main.jsx:
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.jsx'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)

‚îÇ   ‚îú‚îÄ‚îÄ index.css:
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom glass effect classes */
.glass-effect {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.gradient-bg {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.dark-gradient-bg {
  background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
}
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navbar.jsx:
import { Link, useLocation, useNavigate } from "react-router-dom";

function Navbar() {
  const location = useLocation();
  const navigate = useNavigate();
  const user = localStorage.getItem("user");
  const token = localStorage.getItem("token");
  const isAuthenticated = user && token;

  const navLinkClass = (path) => 
    `px-4 py-2 rounded-lg transition-all duration-300 font-medium ${
      location.pathname === path 
        ? 'bg-white text-blue-900 shadow-lg' 
        : 'text-white hover:bg-white/20 hover:shadow-md'
    }`;

  const handleLogout = () => {
    localStorage.removeItem("user");
    localStorage.removeItem("token");
    navigate("/login");
  };

  return (
    <nav className="dark-gradient-bg text-white px-6 py-4 shadow-xl">
      <div className="max-w-7xl mx-auto flex justify-between items-center">
        <div className="flex items-center space-x-3">
          <div className="text-2xl">üèôÔ∏è</div>
          <h1 className="text-2xl font-bold bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent">
            AI-Powered Urban Growth
          </h1>
        </div>
        
        <div className="flex items-center space-x-4">
          {isAuthenticated && (
            <span className="text-blue-100 text-sm">
              Welcome, {user}
            </span>
          )}
          <div className="flex space-x-2">
            {!isAuthenticated ? (
              // Show both Login and Register when user is NOT authenticated
              <>
                <Link to="/login" className={navLinkClass("/login")}>
                  Login
                </Link>
                <Link to="/register" className={navLinkClass("/register")}>
                  Register
                </Link>
              </>
            ) : (
              // Show Dashboard, Reports and Logout when user IS authenticated
              <>
                <Link to="/dashboard" className={navLinkClass("/dashboard")}>
                  Dashboard
                </Link>
                <Link to="/reports" className={navLinkClass("/reports")}>
                  Reports
                </Link>
                <button
                  onClick={handleLogout}
                  className="px-4 py-2 rounded-lg transition-all duration-300 font-medium text-white hover:bg-red-500 hover:shadow-md"
                >
                  Logout
                </button>
              </>
            )}
          </div>
        </div>
      </div>
    </nav>
  );
}

export default Navbar;
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.jsx:
import { Link, useLocation } from "react-router-dom";

function Sidebar() {
  const location = useLocation();

  const menuItems = [
    { path: "/dashboard", icon: "üìä", label: "Overview", description: "Main dashboard" },
    { path: "/population", icon: "üë•", label: "Population", description: "Demographic data" },
    { path: "/infrastructure", icon: "üèóÔ∏è", label: "Infrastructure", description: "Urban development" },
    { path: "/environment", icon: "üåø", label: "Environment", description: "Green spaces & sustainability" },
    { path: "/transport", icon: "üöó", label: "Transport", description: "Mobility & traffic" },
    { path: "/reports", icon: "üìÑ", label: "Reports", description: "Analytics & insights" },
    { path: "/settings", icon: "‚öôÔ∏è", label: "Settings", description: "System configuration" },
  ];

  const isActive = (path) => location.pathname === path;

  return (
    <div className="w-64 bg-white border-r border-gray-200 h-full">
      {/* Sidebar Header */}
      <div className="p-6 border-b border-gray-200">
        <div className="flex items-center space-x-3">
          <div className="text-2xl">üèôÔ∏è</div>
          <div>
            <h2 className="font-semibold text-gray-900">Urban Analytics</h2>
            <p className="text-sm text-gray-500">Navigation</p>
          </div>
        </div>
      </div>

      {/* Menu Items */}
      <nav className="p-4 space-y-2">
        {menuItems.map((item) => (
          <Link
            key={item.path}
            to={item.path}
            className={`flex items-center space-x-3 p-3 rounded-lg transition-all ${
              isActive(item.path)
                ? "bg-blue-50 border border-blue-200 text-blue-700"
                : "text-gray-700 hover:bg-gray-50 hover:text-gray-900"
            }`}
          >
            <div className="text-xl">{item.icon}</div>
            <div className="flex-1">
              <div className="font-medium text-sm">{item.label}</div>
              <div className="text-xs text-gray-500">{item.description}</div>
            </div>
            {isActive(item.path) && (
              <div className="w-2 h-2 bg-blue-600 rounded-full"></div>
            )}
          </Link>
        ))}
      </nav>

      {/* Quick Stats */}
      <div className="p-4 border-t border-gray-200 mt-4">
        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4">
          <h3 className="font-semibold text-sm text-gray-900 mb-2">Quick Stats</h3>
          <div className="space-y-2">
            <div className="flex justify-between text-xs">
              <span className="text-gray-600">Cities Monitored</span>
              <span className="font-semibold">24</span>
            </div>
            <div className="flex justify-between text-xs">
              <span className="text-gray-600">Data Points</span>
              <span className="font-semibold">1.2M</span>
            </div>
            <div className="flex justify-between text-xs">
              <span className="text-gray-600">AI Predictions</span>
              <span className="font-semibold">89%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default Sidebar;
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Footer.jsx:
function Footer() {
  return (
    <footer className="dark-gradient-bg text-white py-8 mt-auto">
      <div className="max-w-7xl mx-auto px-6">
        <div className="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
          <p className="text-blue-100 text-sm">
            ¬© 2025 AI-Powered Urban Growth Dashboard | Smart City Analytics | All Rights Reserved
          </p>
          <div className="flex space-x-6">
            <a href="#privacy" className="text-blue-100 hover:text-white transition-colors text-sm">
              Privacy Policy
            </a>
            <a href="#terms" className="text-blue-100 hover:text-white transition-colors text-sm">
              Terms of Service
            </a>
            <a href="#contact" className="text-blue-100 hover:text-white transition-colors text-sm">
              Contact
            </a>
          </div>
        </div>
      </div>
    </footer>
  );
}

export default Footer;
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProtectedRoute.jsx:
import React from "react";
import { Navigate } from "react-router-dom";

const ProtectedRoute = ({ children }) => {
  const user = localStorage.getItem("user");
  const token = localStorage.getItem("token");
  
  // Check if user is authenticated
  const isAuthenticated = user && token;
  
  if (!isAuthenticated) {
    // Redirect to login if not authenticated
    return <Navigate to="/login" replace />;
  }
  
  return children;
};

export default ProtectedRoute;
‚îÇ   ‚îî‚îÄ‚îÄ pages/
‚îÇ       ‚îú‚îÄ‚îÄ Login.jsx:
import { useState } from "react";
import { useNavigate, Link } from "react-router-dom";
import axios from "axios";

function Login() {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");

    if (username.trim() === "" || password.trim() === "") {
      setError("Please enter both username and password.");
      return;
    }

    try {
      const response = await axios.post("http://localhost:5000/api/users/login", { username, password });
      if (response.data.token) {
        localStorage.setItem("user", username);
        localStorage.setItem("token", response.data.token);
        navigate("/dashboard");
      } else {
        setError("Invalid username or password.");
      }
    } catch (err) {
      setError("Login failed. Please try again.");
      console.error("Login error:", err);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center px-4 py-8 gradient-bg">
      <div className="glass-effect rounded-2xl p-8 md:p-12 w-full max-w-md shadow-2xl">
        <div className="text-center mb-8">
          <div className="text-4xl mb-4">üîê</div>
          <h2 className="text-3xl font-bold text-white mb-2">
            Welcome Back
          </h2>
          <p className="text-blue-100">
            Sign in to access AI Urban Growth Dashboard
          </p>
        </div>
        
        {error && (
          <div className="mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm">
            {error}
          </div>
        )}
        
        <form onSubmit={handleSubmit} className="space-y-6">
          <div>
            <label htmlFor="username" className="block text-white font-medium mb-2 text-left">
              Username
            </label>
            <input
              id="username"
              type="text"
              placeholder="Enter your username"
              value={username}
              onChange={(e) => setUsername(e.target.value)}
              className="w-full px-4 py-3 rounded-xl border border-white/20 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all"
            />
          </div>
          
          <div>
            <label htmlFor="password" className="block text-white font-medium mb-2 text-left">
              Password
            </label>
            <input
              id="password"
              type="password"
              placeholder="Enter your password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-3 rounded-xl border border-white/20 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all"
            />
          </div>
          
          <button
            type="submit"
            className="w-full bg-white text-blue-900 py-3 rounded-xl font-semibold hover:bg-blue-50 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl"
          >
            Sign In
          </button>
        </form>
        
        <div className="mt-6 text-center">
          <p className="text-blue-200 text-sm">
            Don't have an account?{" "}
            <Link to="/register" className="text-white hover:underline font-medium">
              Register here
            </Link>
          </p>
        </div>
        
        <div className="mt-8 pt-8 border-t border-white/20">
          <div className="grid grid-cols-3 gap-4 text-center">
            <div className="text-white">
              <div className="text-2xl mb-2">üìä</div>
              <p className="text-xs">Real-time Analytics</p>
            </div>
            <div className="text-white">
              <div className="text-2xl mb-2">üèòÔ∏è</div>
              <p className="text-xs">Urban Insights</p>
            </div>
            <div className="text-white">
              <div className="text-2xl mb-2">üìà</div>
              <p className="text-xs">Growth Predictions</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default Login;
‚îÇ       ‚îú‚îÄ‚îÄ Register.jsx:
import { useState } from "react";
import { useNavigate, Link } from "react-router-dom";
import axios from "axios";

function Register() {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);

    if (username.trim() === "" || password.trim() === "") {
      setError("Please enter both username and password.");
      setLoading(false);
      return;
    }

    if (password !== confirmPassword) {
      setError("Passwords do not match.");
      setLoading(false);
      return;
    }

    if (password.length < 6) {
      setError("Password must be at least 6 characters long.");
      setLoading(false);
      return;
    }

    try {
      const response = await axios.post("http://localhost:5000/api/users/register", { 
        username, 
        password 
      });
      
      console.log("Registration response:", response.data);
      
      // ‚úÖ FIX: Check for token instead of success field
      if (response.data.token) {
        localStorage.setItem("user", JSON.stringify(response.data.user));
        localStorage.setItem("token", response.data.token);
        navigate("/dashboard");
      } else {
        setError(response.data.message || "Registration failed. Please try again.");
      }
    } catch (err) {
      console.error("Registration error:", err);
      // ‚úÖ FIX: Get proper error message from backend
      setError(
        err.response?.data?.message || 
        err.response?.data?.error || 
        "Registration failed. Please try again."
      );
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center px-4 py-8 gradient-bg">
      <div className="glass-effect rounded-2xl p-8 md:p-12 w-full max-w-md shadow-2xl">
        <div className="text-center mb-8">
          <div className="text-4xl mb-4">üë§</div>
          <h2 className="text-3xl font-bold text-white mb-2">
            Create Account
          </h2>
          <p className="text-blue-100">
            Register to start using AI Urban Growth Dashboard
          </p>
        </div>
        
        {error && (
          <div className="mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm">
            {error}
          </div>
        )}
        
        <form onSubmit={handleSubmit} className="space-y-6">
          <div>
            <label htmlFor="username" className="block text-white font-medium mb-2 text-left">
              Username
            </label>
            <input
              id="username"
              type="text"
              placeholder="Choose a username"
              value={username}
              onChange={(e) => setUsername(e.target.value)}
              className="w-full px-4 py-3 rounded-xl border border-white/20 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all"
              disabled={loading}
            />
          </div>
          
          <div>
            <label htmlFor="password" className="block text-white font-medium mb-2 text-left">
              Password
            </label>
            <input
              id="password"
              type="password"
              placeholder="Create a password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-3 rounded-xl border border-white/20 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all"
              disabled={loading}
            />
          </div>

          <div>
            <label htmlFor="confirmPassword" className="block text-white font-medium mb-2 text-left">
              Confirm Password
            </label>
            <input
              id="confirmPassword"
              type="password"
              placeholder="Confirm your password"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              className="w-full px-4 py-3 rounded-xl border border-white/20 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-transparent transition-all"
              disabled={loading}
            />
          </div>
          
          <button
            type="submit"
            disabled={loading}
            className="w-full bg-white text-blue-900 py-3 rounded-xl font-semibold hover:bg-blue-50 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
          >
            {loading ? "Creating Account..." : "Create Account"}
          </button>
        </form>
        
        <div className="mt-6 text-center">
          <p className="text-blue-200 text-sm">
            Already have an account?{" "}
            <Link to="/login" className="text-white hover:underline font-medium">
              Sign in here
            </Link>
          </p>
        </div>
        
        <div className="mt-8 pt-8 border-t border-white/20">
          <div className="grid grid-cols-3 gap-4 text-center">
            <div className="text-white">
              <div className="text-2xl mb-2">üìä</div>
              <p className="text-xs">Real-time Analytics</p>
            </div>
            <div className="text-white">
              <div className="text-2xl mb-2">üèòÔ∏è</div>
              <p className="text-xs">Urban Insights</p>
            </div>
            <div className="text-white">
              <div className="text-2xl mb-2">üìà</div>
              <p className="text-xs">Growth Predictions</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default Register;
‚îÇ       ‚îú‚îÄ‚îÄ Dashboard.jsx:
import React, { useState, useEffect, useCallback } from "react";
import axios from "axios";
import { useNavigate } from "react-router-dom";
import Sidebar from "../components/Sidebar";

function Dashboard() {
  const username = localStorage.getItem("user") || "user";
  const token = localStorage.getItem("token");
  const [activeTab, setActiveTab] = useState("overview");
  const [isLoading, setIsLoading] = useState(true);
  const navigate = useNavigate();

  const handleLogout = async () => {
    try {
      await axios.post("http://localhost:5000/api/data", {
        username,
        analysisResult: "User logged out via dashboard",
        actionType: "logout",
        city: "System"
      }, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
    } catch (err) {
      console.error("Logout save failed:", err);
    } finally {
      localStorage.removeItem("user");
      localStorage.removeItem("token");
      navigate("/login");
    }
  };

  const fetchData = useCallback(async () => {
    // Silently fetch data for internal tracking only
    try {
      await axios.get("http://localhost:5000/api/data", {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      setIsLoading(false);
    } catch (error) {
      console.error("Error fetching data:", error);
      setIsLoading(false);
    }
  }, [token]);

  useEffect(() => {
    fetchData();
  }, [fetchData]);

  useEffect(() => {
    const saveUserLogin = async () => {
      if (username && username !== "user" && token) {
        try {
          await axios.post("http://localhost:5000/api/data", {
            username,
            analysisResult: "User accessed dashboard",
            actionType: "login",
            city: "System"
          }, {
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });
          console.log("‚úÖ Dashboard access event saved to database");
        } catch (err) {
          console.error("Failed to auto-save dashboard access:", err);
        }
      }
    };
    saveUserLogin();
  }, [username, token]);

  if (isLoading) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600 font-medium">Loading Urban Analytics...</p>
        </div>
      </div>
    );
  }

  return (
    <div className="flex-1 flex flex-col overflow-hidden">
      <div className="bg-white border-b border-gray-200 shadow-sm">
        <div className="px-6 py-4">
          <div className="flex flex-col lg:flex-row lg:items-center lg:justify-between">
            <div>
              <h1 className="text-2xl font-bold text-gray-900">Urban Growth Analytics</h1>
              <p className="text-gray-600 mt-1">
                Welcome back, <span className="text-blue-600 font-semibold">{username}</span> ‚Ä¢ Last updated: {new Date().toLocaleString()}
              </p>
            </div>
            <div className="flex items-center space-x-4 mt-4 lg:mt-0">
              <button className="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors flex items-center space-x-2">
                <span>üìÖ</span>
                <span>This Month</span>
              </button>
              <button className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                <span>üì•</span>
                <span>Export Report</span>
              </button>
              <button 
                onClick={handleLogout}
                className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2"
              >
                <span>üö™</span>
                <span>Logout</span>
              </button>
            </div>
          </div>
        </div>

        <div className="px-6 pb-4">
          <div className="flex space-x-1 bg-gray-100 rounded-xl p-1">
            {["overview", "population", "infrastructure", "environment", "reports"].map((tab) => (
              <button
                key={tab}
                onClick={() => setActiveTab(tab)}
                className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${
                  activeTab === tab
                    ? "bg-white text-blue-600 shadow-sm"
                    : "text-gray-600 hover:text-gray-900"
                }`}
              >
                {tab.charAt(0).toUpperCase() + tab.slice(1)}
              </button>
            ))}
          </div>
        </div>
      </div>

      <div className="flex min-h-screen">
        <Sidebar />
        <div className="flex-1 overflow-auto p-6">
          {/* Streamlit Dashboard with username parameter */}
          <div className="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200">
            <div className="border-b border-gray-200 px-6 py-4 bg-gradient-to-r from-gray-50 to-blue-50">
              <div className="flex items-center justify-between">
                <div>
                  <h3 className="text-lg font-semibold text-gray-900">Live Urban Analytics Dashboard</h3>
                  <p className="text-sm text-gray-600">Real-time data visualization and predictive analytics</p>
                </div>
                <div className="flex items-center space-x-2">
                  <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                  <span className="text-xs text-green-600 font-medium">Live</span>
                </div>
              </div>
            </div>
            <iframe
              src={`http://localhost:8501?username=${encodeURIComponent(username)}`}
              width="100%"
              height="800px"
              className="border-0"
              title="Streamlit Dashboard"
            />
          </div>
        </div>
      </div>
    </div>
  );
}

export default Dashboard;
‚îÇ       ‚îî‚îÄ‚îÄ Reports.jsx:
import React from "react";

function Reports() {
  const reports = [
    {
      id: 1,
      title: "Population Density Analysis",
      description: "Comprehensive analysis of urban population distribution and density patterns across metropolitan areas",
      date: "2025-01-15",
      type: "PDF",
      icon: "üìä"
    },
    {
      id: 2,
      title: "Infrastructure Development Report",
      description: "Current state and future projections of urban infrastructure development and capacity planning",
      date: "2025-01-10",
      type: "PDF",
      icon: "üèóÔ∏è"
    },
    {
      id: 3,
      title: "Environmental Impact Assessment",
      description: "Detailed analysis of urban growth effects on local ecosystems and environmental sustainability",
      date: "2025-01-05",
      type: "PDF",
      icon: "üåø"
    }
  ];

  return (
    <div className="min-h-screen bg-gray-50 py-8 px-4">
      <div className="max-w-7xl mx-auto">
        <div className="text-center mb-12">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            Urban Development Reports
          </h1>
          <p className="text-xl text-gray-600 max-w-2xl mx-auto">
            AI-powered analysis and insights for data-driven urban planning and sustainable development
          </p>
        </div>
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {reports.map(report => (
            <div key={report.id} className="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 hover:border-blue-200 group">
              <div className="flex items-start justify-between mb-4">
                <div className="text-3xl">{report.icon}</div>
                <span className="bg-red-100 text-red-800 text-xs font-semibold px-3 py-1 rounded-full">
                  {report.type}
                </span>
              </div>
              
              <div className="mb-4">
                <h3 className="font-semibold text-gray-900 text-lg mb-2 group-hover:text-blue-600 transition-colors">
                  {report.title}
                </h3>
                <p className="text-gray-600 text-sm leading-relaxed">
                  {report.description}
                </p>
              </div>
              
              <div className="flex items-center justify-between mt-6">
                <span className="text-gray-500 text-sm">
                  {report.date}
                </span>
                <button className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transform hover:scale-105 transition-all duration-300 text-sm font-semibold">
                  Download
                </button>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

export default Reports;
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ vite.config.js
notebooks/
‚îú‚îÄ‚îÄ 01_explore_images.ipynb:
# Notebook config (run this first cell)
from pathlib import Path
import os, sys

BASE = Path(r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT")   # change if needed
DATA = BASE / "data"
IMAGES = DATA / "images"
POP = DATA / "population"
ROADS = DATA / "roads"
BOUNDARIES = DATA / "boundaries"
PROCESSED = DATA / "processed"
PATCHES = DATA / "patches"
OUTPUTS = BASE / "outputs"

# Create folders (safe)
for p in [PROCESSED, PATCHES, OUTPUTS, OUTPUTS/"maps", OUTPUTS/"charts"]:
    p.mkdir(parents=True, exist_ok=True)

print("Base:", BASE)
print("Images folder:", IMAGES)

import rasterio
from matplotlib import pyplot as plt
import os

folder = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\Pune Data"
for file in os.listdir(folder):
    if file.endswith('.TIF'):
        with rasterio.open(folder + "\\" + file) as src:  # Add \\ as separator
            data = src.read(1)
        plt.imshow(data, cmap='gray')
        plt.title(file)
        plt.show()

import rasterio
import numpy as np
import matplotlib.pyplot as plt

# Band paths
band_paths = {
    "B1": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B1.TIF",
    "B2": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B2.TIF",
    "B3": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B3.TIF",  # Red
    "B4": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B4.TIF",  # NIR
    "B5": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B5.TIF",
    "B6": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B6.TIF",  # SWIR1
    "B7": r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B7.TIF"
}

# Read bands
def read_band(path):
    with rasterio.open(path) as src:
        return src.read(1).astype("float32")

red = read_band(band_paths["B3"])
nir = read_band(band_paths["B4"])
green = read_band(band_paths["B2"])
swir = read_band(band_paths["B6"])

# Calculate indices
ndvi = (nir - red) / (nir + red + 1e-10)
ndbi = (swir - nir) / (swir + nir + 1e-10)
ndwi = (green - nir) / (green + nir + 1e-10)

# Plot results
fig, axs = plt.subplots(1, 3, figsize=(18, 6))

axs[0].imshow(ndvi, cmap="RdYlGn")
axs[0].set_title("NDVI (Vegetation)")

axs[1].imshow(ndbi, cmap="RdYlBu")
axs[1].set_title("NDBI (Built-up)")

axs[2].imshow(ndwi, cmap="Blues")
axs[2].set_title("NDWI (Water Index)")

plt.colorbar(axs[0].images[0], ax=axs[0], fraction=0.046, pad=0.04)
plt.colorbar(axs[1].images[0], ax=axs[1], fraction=0.046, pad=0.04)
plt.colorbar(axs[2].images[0], ax=axs[2], fraction=0.046, pad=0.04)

plt.tight_layout()
plt.show()


‚îú‚îÄ‚îÄ 02_process_population.ipynb:
import rasterio
import numpy as np
from rasterio.warp import reproject, Resampling
import os

# Reference raster (from your satellite data, ensures same grid/extent)
ref_raster = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B3.TIF"

# Input population rasters (WorldPop/GPW for India)
pop_files = {
    2000: r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif",
    2005: r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2005_1km_UNadj.tif",
    2010: r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2010_1km_UNadj.tif",
    2015: r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2015_1km_UNadj.tif",
    2020: r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2020_1km_UNadj.tif"
}

# Output folder
out_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed"
os.makedirs(out_dir, exist_ok=True)

# Load reference metadata (satellite band)
with rasterio.open(ref_raster) as ref:
    ref_meta = ref.meta.copy()

# Loop through all population years
for year, pop_in in pop_files.items():
    pop_out = os.path.join(out_dir, f"resampled_pop_{year}.tif")
    
    with rasterio.open(pop_in) as src:
        src_arr = src.read(1)

        dst = np.empty((ref_meta['height'], ref_meta['width']), dtype='float32')

        reproject(
            source=src_arr,
            destination=dst,
            src_transform=src.transform,
            src_crs=src.crs,
            dst_transform=ref_meta['transform'],
            dst_crs=ref_meta['crs'],
            resampling=Resampling.bilinear
        )

        out_meta = ref_meta.copy()
        out_meta.update(dtype='float32', count=1)

        with rasterio.open(pop_out, 'w', **out_meta) as dstf:
            dstf.write(dst.astype('float32'), 1)

    print(f"‚úÖ Saved resampled population raster: {pop_out}")


‚îú‚îÄ‚îÄ 03_roads_boundaries.ipynb:
import os
import osmnx as ox
import geopandas as gpd

# Choose place name exactly; "Pune, India" works
place = "Pune, Maharashtra, India"

# Fetch road network (drive type; use 'all' for everything)
G = ox.graph_from_place(place, network_type='drive')

# Convert to GeoDataFrame edges
gdf_edges = ox.graph_to_gdfs(G, nodes=False, edges=True)

# Save shapefile
out_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\roads"
os.makedirs(out_dir, exist_ok=True)
roads_shp = os.path.join(out_dir, "pune_roads.shp")
gdf_edges.to_file(roads_shp)
print("Saved roads shapefile:", roads_shp)
gdf_edges.head()
import matplotlib.pyplot as plt

# Plot the roads
fig, ax = plt.subplots(figsize=(10, 10))
gdf_edges.plot(ax=ax, linewidth=0.5, color="blue")
plt.title("Pune Road Network", fontsize=15)
plt.show()

‚îú‚îÄ‚îÄ 04_feature_engineering.ipynb:
import geopandas as gpd
import rasterio
from rasterio import features
import numpy as np
from shapely.geometry import mapping
import matplotlib.pyplot as plt
import os
roads_fp = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\roads\pune_roads.shp"
roads = gpd.read_file(roads_fp)
roads.head()

ref_raster = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif"
with rasterio.open(ref_raster) as src:
    meta = src.meta.copy()
    out_shape = (src.height, src.width)
    transform = src.transform
shapes = ((geom, 1) for geom in roads.geometry)
roads_raster = features.rasterize(
    shapes=shapes,
    out_shape=out_shape,
    transform=transform,
    fill=0,
    dtype="uint8"
)

# Save rasterized roads
roads_mask_fp = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif"
with rasterio.open(roads_mask_fp, 'w', **meta) as dst:
    dst.write(roads_raster, 1)

print("Saved rasterized roads:", roads_mask_fp)
from scipy.ndimage import distance_transform_edt

# Roads are 1 ‚Üí invert mask so background=1, roads=0
inverted = 1 - roads_raster
dist_raster = distance_transform_edt(inverted) * transform.a  # pixel size

# Save distance raster
roads_dist_fp = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif"
with rasterio.open(roads_dist_fp, 'w', **meta) as dst:
    dst.write(dist_raster.astype('float32'), 1)

print("Saved distance-to-roads raster:", roads_dist_fp)

plt.figure(figsize=(12,5))
plt.subplot(1,2,1)
plt.title("Roads Mask")
plt.imshow(roads_raster, cmap="gray")

plt.subplot(1,2,2)
plt.title("Distance to Roads")
plt.imshow(dist_raster, cmap="magma")
plt.colorbar(label="meters")
plt.show()

import rasterio
import matplotlib.pyplot as plt

# File paths
files = [
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2005_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2010_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2015_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2020_1km_UNadj.tif"
]

titles = ["Population 2000", "Population 2005", "Population 2010", "Population 2015", "Population 2020"]

# Load rasters
rasters = []
for f in files:
    with rasterio.open(f) as src:
        rasters.append(src.read(1))

# Plot them in a row (5 subplots)
plt.figure(figsize=(20, 5))

for i, (data, title) in enumerate(zip(rasters, titles)):
    plt.subplot(1, 5, i+1)
    plt.imshow(data, cmap="viridis")
    plt.title(title, fontsize=10)
    plt.axis("off")

plt.tight_layout()
plt.show()

import rasterio
import numpy as np
import os

# File paths
pop_files = [
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2000_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2005_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2010_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2015_1km_UNadj.tif",
    r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\population\ind_pd_2020_1km_UNadj.tif"
]

population_layers = []
for f in pop_files:
    with rasterio.open(f) as src:
        population_layers.append(src.read(1))

population_stack = np.stack(population_layers, axis=-1)
print("Population stack shape:", population_stack.shape)  # (height, width, 5)

dist_road_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed\resampled_pop_2000.tif"
with rasterio.open(dist_road_path) as src:
    dist_to_road = src.read(1)

print("Distance-to-road shape:", dist_to_road.shape)

# Example Landsat bands (update filenames if different in your images folder)
red_band = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B4.TIF"
nir_band = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\images\LC09_L2SP_147047_20250902_20250904_02_T2_SR_B5.TIF"

with rasterio.open(red_band) as red_src, rasterio.open(nir_band) as nir_src:
    red = red_src.read(1).astype("float32")
    nir = nir_src.read(1).astype("float32")

ndvi = (nir - red) / (nir + red + 1e-6)  # avoid division by zero
print("NDVI shape:", ndvi.shape)
# Align shapes if needed
min_shape = (
    min(population_stack.shape[0], dist_to_road.shape[0], ndvi.shape[0]),
    min(population_stack.shape[1], dist_to_road.shape[1], ndvi.shape[1])
)

# Crop arrays to same shape
population_stack = population_stack[:min_shape[0], :min_shape[1], :]
dist_to_road = dist_to_road[:min_shape[0], :min_shape[1]]
ndvi = ndvi[:min_shape[0], :min_shape[1]]

# Final feature stack
features_stack = np.dstack([population_stack, dist_to_road, ndvi])
print("Final features stack shape:", features_stack.shape)  
# Example: (height, width, 7) ‚Üí 5 pop layers + 1 road + 1 NDVI
out_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed\features_stack.npz"
os.makedirs(os.path.dirname(out_path), exist_ok=True)

np.savez_compressed(out_path, features=features_stack)
print("‚úÖ Saved feature stack at:", out_path)




‚îú‚îÄ‚îÄ 05_patches_preprocessing.ipynb:
import numpy as np
from sklearn.model_selection import train_test_split
import os

data_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed\features_stack.npz"
data = np.load(data_path)
print("Available keys:", list(data.keys()))

# Load feature data
features = data["features"]  # shape: (3451, 3508, 7)
print("Features shape:", features.shape)

# -----------------------------
# 1. Parameters
# -----------------------------
PATCH_SIZE = 64
train_ratio = 0.7
val_ratio = 0.15
test_ratio = 0.15

# -----------------------------
# 2. Patch Creation
# -----------------------------
def create_patches(features, patch_size=64):
    """Create patches from (H, W, Bands) raster."""
    H, W, B = features.shape
    patches = []
    
    for i in range(0, H - patch_size + 1, patch_size):
        for j in range(0, W - patch_size + 1, patch_size):
            patch = features[i:i+patch_size, j:j+patch_size, :]
            patches.append(patch)
    patches = np.array(patches)
    print(f"‚úÖ Created {patches.shape[0]} patches of size {patch_size}x{patch_size} with {B} bands.")
    return patches

patches = create_patches(features, PATCH_SIZE)
print("Patches shape:", patches.shape)

# -----------------------------
# 3. Normalize per band
# -----------------------------
def normalize_patches(patches):
    """Normalize each patch per band."""
    patches = patches.astype("float32")
    for b in range(patches.shape[-1]):
        band = patches[..., b]
        min_val, max_val = band.min(), band.max()
        patches[..., b] = (band - min_val) / (max_val - min_val + 1e-6)
    return patches

patches = normalize_patches(patches)
print("Normalized range:", patches.min(), patches.max())

# -----------------------------
# 4. Train/Val/Test Split
# -----------------------------
X_train, X_temp = train_test_split(patches, test_size=(1-train_ratio), random_state=42)
X_val, X_test = train_test_split(X_temp, test_size=test_ratio/(test_ratio+val_ratio), random_state=42)

print("Train:", X_train.shape)
print("Val:", X_val.shape)
print("Test:", X_test.shape)

# -----------------------------
# 5. Save to Disk
# -----------------------------
output_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed"
os.makedirs(output_dir, exist_ok=True)

np.savez_compressed(os.path.join(output_dir, "train.npz"), X=X_train)
np.savez_compressed(os.path.join(output_dir, "val.npz"), X=X_val)
np.savez_compressed(os.path.join(output_dir, "test.npz"), X=X_test)

print("‚úÖ Saved train/val/test patch datasets!")

‚îú‚îÄ‚îÄ 06_model_training.ipynb:
import numpy as np
import tensorflow as tf
from tensorflow.keras import layers, models
import matplotlib.pyplot as plt
import os
import numpy as np
import os
import sys

# Try to import required packages with error handling
try:
    import tensorflow as tf
    from tensorflow.keras import layers, models
    print("‚úÖ TensorFlow/Keras imported successfully")
except ImportError as e:
    print(f"‚ùå Error importing TensorFlow: {e}")
    sys.exit(1)

try:
    import matplotlib.pyplot as plt
    print("‚úÖ Matplotlib imported successfully")
except ImportError as e:
    print(f"‚ùå Error importing matplotlib: {e}")
    sys.exit(1)

# -----------------------------
# 1. Load datasets - FIXED VERSION
# -----------------------------
base_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\processed"

try:
    # Load the existing data
    train = np.load(os.path.join(base_dir, "train.npz"))
    val = np.load(os.path.join(base_dir, "val.npz"))
    test = np.load(os.path.join(base_dir, "test.npz"))

    # Extract input data (X)
    X_train = train['X']
    X_val = val['X']
    X_test = test['X']

    print("‚úÖ Input data loaded successfully!")
    print(f"X_train: {X_train.shape}")
    print(f"X_val: {X_val.shape}")
    print(f"X_test: {X_test.shape}")

except Exception as e:
    print(f"‚ùå Error loading data: {e}")
    sys.exit(1)

# Create target labels (y) - using a simple approach
print("\nüîß Creating target labels for urban growth detection...")

try:
    # Method: Create binary masks based on intensity threshold
    y_train = (X_train[:, :, :, 0] > np.percentile(X_train[:, :, :, 0], 70)).astype(np.float32)[:, :, :, np.newaxis]
    y_val = (X_val[:, :, :, 0] > np.percentile(X_val[:, :, :, 0], 70)).astype(np.float32)[:, :, :, np.newaxis]
    y_test = (X_test[:, :, :, 0] > np.percentile(X_test[:, :, :, 0], 70)).astype(np.float32)[:, :, :, np.newaxis]

    print("‚úÖ Target labels created!")
    print(f"y_train: {y_train.shape}")
    print(f"y_val: {y_val.shape}")
    print(f"y_test: {y_test.shape}")

except Exception as e:
    print(f"‚ùå Error creating labels: {e}")
    sys.exit(1)

finally:
    # Close the files
    train.close()
    val.close()
    test.close()

# -----------------------------
# 2. Data Validation and Preprocessing
# -----------------------------
print(f"\nüìä Data validation:")
print(f"X_train range: [{X_train.min():.3f}, {X_train.max():.3f}]")
print(f"y_train unique values: {np.unique(y_train)}")

# Normalize input data to [0, 1] range
try:
    if X_train.max() > 1.0:
        X_train = X_train.astype(np.float32) / 255.0
        X_val = X_val.astype(np.float32) / 255.0
        X_test = X_test.astype(np.float32) / 255.0
        print("‚úÖ Input data normalized to [0, 1]")
    else:
        print("‚úÖ Input data already normalized")
except Exception as e:
    print(f"‚ùå Error normalizing data: {e}")

# -----------------------------
# 3. Simplified CNN Model (More compatible)
# -----------------------------
def build_simple_unet(input_shape):
    """Build a simplified U-Net model for better compatibility"""
    inputs = tf.keras.Input(shape=input_shape)
    
    # Encoder
    # Block 1
    x = layers.Conv2D(32, 3, activation='relu', padding='same')(inputs)
    x = layers.Conv2D(32, 3, activation='relu', padding='same')(x)
    x = layers.MaxPooling2D(2)(x)
    
    # Block 2
    x = layers.Conv2D(64, 3, activation='relu', padding='same')(x)
    x = layers.Conv2D(64, 3, activation='relu', padding='same')(x)
    x = layers.MaxPooling2D(2)(x)
    
    # Block 3 (Bottleneck)
    x = layers.Conv2D(128, 3, activation='relu', padding='same')(x)
    x = layers.Conv2D(128, 3, activation='relu', padding='same')(x)
    
    # Decoder
    # Block 4
    x = layers.UpSampling2D(2)(x)
    x = layers.Conv2D(64, 3, activation='relu', padding='same')(x)
    x = layers.Conv2D(64, 3, activation='relu', padding='same')(x)
    
    # Block 5
    x = layers.UpSampling2D(2)(x)
    x = layers.Conv2D(32, 3, activation='relu', padding='same')(x)
    x = layers.Conv2D(32, 3, activation='relu', padding='same')(x)
    
    # Output layer
    outputs = layers.Conv2D(1, 1, activation='sigmoid')(x)
    
    model = tf.keras.Model(inputs, outputs)
    return model

# Build model
input_shape = X_train.shape[1:]
print(f"\nüèóÔ∏è Building U-Net model with input shape: {input_shape}")

try:
    model = build_simple_unet(input_shape)
    print("‚úÖ Model built successfully!")
except Exception as e:
    print(f"‚ùå Error building model: {e}")
    sys.exit(1)

# -----------------------------
# 4. Compile model
# -----------------------------
try:
    model.compile(
        optimizer='adam',
        loss='binary_crossentropy',
        metrics=['accuracy', 'mae']
    )
    print("‚úÖ Model compiled successfully!")
except Exception as e:
    print(f"‚ùå Error compiling model: {e}")
    sys.exit(1)

# Display model summary
try:
    model.summary()
except:
    print("‚ö†Ô∏è  Could not display model summary, but model is built")

# -----------------------------
# 5. Train model
# -----------------------------
print("\nüöÄ Starting training...")

try:
    history = model.fit(
        X_train, y_train,
        validation_data=(X_val, y_val),
        epochs=5,  # Reduced for testing
        batch_size=8,
        verbose=1
    )
    print("\n‚úÖ Training completed!")
except Exception as e:
    print(f"‚ùå Error during training: {e}")
    # Continue with saved model if available
    history = None

# -----------------------------
# 6. Plot training history (if available)
# -----------------------------
if history is not None:
    try:
        plt.figure(figsize=(15, 5))
        
        # Plot loss
        plt.subplot(1, 3, 1)
        plt.plot(history.history['loss'], label='Training Loss')
        if 'val_loss' in history.history:
            plt.plot(history.history['val_loss'], label='Validation Loss')
        plt.title('Model Loss')
        plt.xlabel('Epoch')
        plt.ylabel('Loss')
        plt.legend()
        
        # Plot accuracy
        plt.subplot(1, 3, 2)
        plt.plot(history.history['accuracy'], label='Training Accuracy')
        if 'val_accuracy' in history.history:
            plt.plot(history.history['val_accuracy'], label='Validation Accuracy')
        plt.title('Model Accuracy')
        plt.xlabel('Epoch')
        plt.ylabel('Accuracy')
        plt.legend()
        
        # Plot MAE
        plt.subplot(1, 3, 3)
        plt.plot(history.history['mae'], label='Training MAE')
        if 'val_mae' in history.history:
            plt.plot(history.history['val_mae'], label='Validation MAE')
        plt.title('Mean Absolute Error')
        plt.xlabel('Epoch')
        plt.ylabel('MAE')
        plt.legend()
        
        plt.tight_layout()
        plt.show()
        print("‚úÖ Training plots generated!")
        
    except Exception as e:
        print(f"‚ö†Ô∏è  Could not generate training plots: {e}")

# -----------------------------
# 7. Save model
# -----------------------------
try:
    model_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\models"
    os.makedirs(model_dir, exist_ok=True)
    model_path = os.path.join(model_dir, "urban_growth_unet.h5")
    model.save(model_path)
    print(f"‚úÖ Model saved successfully at:\n{model_path}")
except Exception as e:
    print(f"‚ùå Error saving model: {e}")

# -----------------------------
# 8. Evaluate on test set
# -----------------------------
print("\nüß™ Evaluating on test set...")
try:
    test_loss, test_accuracy, test_mae = model.evaluate(X_test, y_test, verbose=0)
    print(f"üìä Test Loss: {test_loss:.4f}")
    print(f"üìä Test Accuracy: {test_accuracy:.4f}")
    print(f"üìä Test MAE: {test_mae:.4f}")
except Exception as e:
    print(f"‚ùå Error during evaluation: {e}")

# -----------------------------
# 9. Show sample predictions
# -----------------------------
print("\nüé® Generating sample predictions...")
try:
    # Use first 5 samples for prediction
    sample_indices = range(min(5, len(X_test)))
    preds = model.predict(X_test[sample_indices], verbose=0)
    
    plt.figure(figsize=(15, 10))
    
    for i in sample_indices:
        # Input image (first channel)
        plt.subplot(3, 5, i + 1)
        plt.imshow(X_test[i, :, :, 0], cmap='viridis')
        plt.title(f"Input {i}")
        plt.axis('off')
        
        # True mask
        plt.subplot(3, 5, i + 6)
        plt.imshow(y_test[i, :, :, 0], cmap='gray')
        plt.title("True Mask")
        plt.axis('off')
        
        # Predicted mask
        plt.subplot(3, 5, i + 11)
        plt.imshow(preds[i, :, :, 0], cmap='gray')
        plt.title("Predicted")
        plt.axis('off')
    
    plt.suptitle('Urban Growth Detection - Sample Predictions', fontsize=16)
    plt.tight_layout()
    plt.show()
    print("‚úÖ Predictions visualized successfully!")
    
except Exception as e:
    print(f"‚ùå Error during prediction visualization: {e}")

# -----------------------------
# 10. Save predictions
# -----------------------------
try:
    predictions_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\predictions"
    os.makedirs(predictions_dir, exist_ok=True)
    
    # Save test predictions
    test_predictions = model.predict(X_test, verbose=0)
    np.savez_compressed(
        os.path.join(predictions_dir, "test_predictions.npz"),
        predictions=test_predictions,
        ground_truth=y_test
    )
    print(f"‚úÖ Predictions saved to {predictions_dir}")
    
except Exception as e:
    print(f"‚ùå Error saving predictions: {e}")

print("\n" + "="*50)
print("üéâ PIPELINE EXECUTION COMPLETED!")
print("="*50)
print("üìù Summary:")
print("  ‚úÖ Data loaded and preprocessed")
print("  ‚úÖ Model built and trained")
print("  ‚úÖ Predictions generated")
print("  ‚úÖ Results saved")
print("\n‚ö†Ô∏è  Note: Labels are auto-generated for demonstration.")
print("   Replace with actual ground truth data for production use.")
print("="*50)

‚îú‚îÄ‚îÄ 07_dashboard_integration.ipynb:
from tensorflow.keras.models import load_model
import numpy as np
import matplotlib.pyplot as plt
import os

model_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\models\urban_growth_unet.h5"
model = load_model(model_path)

predictions_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\predictions"
preds_file = os.path.join(predictions_dir, "test_predictions.npz")
data = np.load(preds_file)
preds, y_test = data["predictions"], data["ground_truth"]
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, jaccard_score

y_true_flat = y_test.flatten() > 0.5
y_pred_flat = preds.flatten() > 0.5

acc = accuracy_score(y_true_flat, y_pred_flat)
prec = precision_score(y_true_flat, y_pred_flat)
rec = recall_score(y_true_flat, y_pred_flat)
f1 = f1_score(y_true_flat, y_pred_flat)
iou = jaccard_score(y_true_flat, y_pred_flat)

print(f"Accuracy: {acc:.4f}")
print(f"Precision: {prec:.4f}")
print(f"Recall: {rec:.4f}")
print(f"F1-Score: {f1:.4f}")
print(f"IoU: {iou:.4f}")
import random

n = 5
idxs = random.sample(range(len(preds)), n)

plt.figure(figsize=(15, 9))
for i, idx in enumerate(idxs):
    plt.subplot(3, n, i + 1)
    plt.imshow(y_test[idx, :, :, 0], cmap='gray')
    plt.title("Ground Truth")
    plt.axis('off')

    plt.subplot(3, n, n + i + 1)
    plt.imshow(preds[idx, :, :, 0], cmap='gray')
    plt.title("Predicted Mask")
    plt.axis('off')

    plt.subplot(3, n, 2 * n + i + 1)
    diff = np.abs(y_test[idx, :, :, 0] - preds[idx, :, :, 0])
    plt.imshow(diff, cmap='hot')
    plt.title("Difference")
    plt.axis('off')

plt.suptitle("Model Evaluation Visualization", fontsize=16)
plt.tight_layout()
plt.show()


‚îú‚îÄ‚îÄ 08_dashboard_integration.py:
import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
import tensorflow as tf
import os
from sklearn.metrics import accuracy_score, f1_score, jaccard_score

# ---------------------------
# 1. Load Model
# ---------------------------
model_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\models\urban_growth_unet.h5"
model = tf.keras.models.load_model(model_path)

st.title("üåÜ Urban Growth Prediction Dashboard")
st.markdown("Visualize **predicted urban expansion** over time with AI-powered insights.")

# ---------------------------
# 2. Load Data
# ---------------------------
predictions_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\predictions"
data = np.load(os.path.join(predictions_dir, "test_predictions.npz"))
preds, y_test = data["predictions"], data["ground_truth"]

# ---------------------------
# 3. Metrics
# ---------------------------
y_true_flat = y_test.flatten() > 0.5
y_pred_flat = preds.flatten() > 0.5
acc = accuracy_score(y_true_flat, y_pred_flat)
f1 = f1_score(y_true_flat, y_pred_flat)
iou = jaccard_score(y_true_flat, y_pred_flat)

st.subheader("üìä Model Performance Metrics")
st.write(f"**Accuracy:** {acc:.4f}")
st.write(f"**F1-Score:** {f1:.4f}")
st.write(f"**IoU:** {iou:.4f}")

# ---------------------------
# 4. Visualization
# ---------------------------
st.subheader("üñºÔ∏è Urban Growth Prediction Samples")

idx = st.slider("Select Sample Index", 0, len(preds)-1, 0)

col1, col2, col3 = st.columns(3)
with col1:
    st.image(y_test[idx, :, :, 0], caption="Ground Truth", use_container_width=True)
with col2:
    st.image(preds[idx, :, :, 0], caption="Predicted Mask", use_container_width=True)
with col3:
    diff = np.abs(y_test[idx, :, :, 0] - preds[idx, :, :, 0])
    st.image(diff, caption="Difference Map", use_container_width=True)

# ---------------------------
# 5. Trend Chart (Dummy)
# ---------------------------
st.subheader("üìà Urban Growth Over Time")
years = [2000, 2005, 2010, 2015, 2020, 2030, 2040]
growth = [10, 18, 25, 40, 55, 70, 88]

fig, ax = plt.subplots()
ax.plot(years, growth, marker="o")
ax.set_xlabel("Year")
ax.set_ylabel("Urban Growth %")
ax.set_title("Urban Growth Projection")
st.pyplot(fig)

streamlite_app/
‚îú‚îÄ‚îÄ app.py:
import streamlit as st
import sys
import os
import requests

# Add current directory to Python path
sys.path.append(os.path.dirname(__file__))
from utils import get_token

st.set_page_config(
    page_title="Urban Growth Analytics",
    page_icon="üèôÔ∏è",
    layout="wide",
    initial_sidebar_state="expanded"
)

def main():
    st.sidebar.title("üèôÔ∏è Urban Growth Analytics")
    st.sidebar.markdown("---")
    
    # Check authentication
    token = get_token()
    
    if token:
        # User is logged in - show dashboard directly
        st.switch_page("pages/dashboard.py")
    else:
        # User is not logged in - show welcome page
        show_welcome_page()

def show_welcome_page():
    st.title("üåÜ Welcome to Urban Growth Analytics")
    st.subheader("Monitor and Predict Urban Development with Advanced Analytics")
    
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.markdown("""
        ### üß† Advanced Features:
        - **Urban Growth Prediction**: U-Net model for accurate urban expansion forecasts
        - **Satellite Image Analysis**: Deep learning-based analysis of urban development patterns
        - **Real-time Analytics**: Live monitoring of urban growth metrics
        - **Predictive Modeling**: Data-driven projections for urban planning
        
        ### üìä What You Can Do:
        - Visualize model predictions vs ground truth
        - Analyze urban growth trends over time
        - Monitor model performance metrics (Accuracy, F1-Score, IoU)
        - Generate urban expansion probability maps
        
        ### üöÄ Get Started:
        1. Create an account or login
        2. Access the Dashboard
        3. Explore urban growth predictions
        4. Analyze model performance
        """)
    
    with col2:
        st.image("https://cdn-icons-png.flaticon.com/512/3079/3079165.png", width=150)
        st.markdown("---")
        st.info("""
        **üîê Secure Access**  
        
        Login to access advanced urban growth predictions and analytics.
        """)
    
    # Quick actions
    st.markdown("---")
    st.subheader("Quick Access")
    
    col1, col2 = st.columns(2)
    
    with col1:
        if st.button("üîê Login to Dashboard", use_container_width=True):
            st.switch_page("pages/login.py")
    
    with col2:
        if st.button("üìù Create Account", use_container_width=True):
            st.switch_page("pages/register.py")
    
    # System status
    st.markdown("---")
    st.subheader("üîß System Status")
    
    col1, col2 = st.columns(2)
    
    with col1:
        try:
            response = requests.get("http://localhost:5000/", timeout=5)
            if response.status_code == 200:
                st.success("‚úÖ Backend server is running")
            else:
                st.warning("‚ö†Ô∏è Backend server response unexpected")
        except:
            st.error("‚ùå Backend server is not available")
    
    with col2:
        # Check if model files exist without loading them
        model_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\models\urban_growth_unet.h5"
        data_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\predictions\test_predictions.npz"
        
        if os.path.exists(model_path) and os.path.exists(data_path):
            st.success("‚úÖ Model files available")
        else:
            st.error("‚ùå Model files not found")

if __name__ == "__main__":
    main()
‚îú‚îÄ‚îÄ urban_predictor.py:
import numpy as np
import tensorflow as tf
import os
from sklearn.metrics import accuracy_score, f1_score, jaccard_score
import matplotlib.pyplot as plt

class UrbanGrowthPredictor:
    def __init__(self):
        self.model = None
        self.predictions = None
        self.ground_truth = None
        self.metrics = None
        self.load_model()
        self.load_data()
        self.calculate_metrics()
    
    def load_model(self):
        """Load the trained U-Net model"""
        try:
            model_path = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\models\urban_growth_unet.h5"
            if os.path.exists(model_path):
                self.model = tf.keras.models.load_model(model_path)
                print("‚úÖ Model loaded successfully")
            else:
                print(f"‚ùå Model file not found: {model_path}")
        except Exception as e:
            print(f"‚ùå Error loading model: {e}")
    
    def load_data(self):
        """Load prediction data"""
        try:
            predictions_dir = r"C:\Users\Lenovo\Desktop\LY MAJOR PROJECT\data\predictions"
            data_path = os.path.join(predictions_dir, "test_predictions.npz")
            
            if os.path.exists(data_path):
                data = np.load(data_path)
                self.predictions = data["predictions"]
                self.ground_truth = data["ground_truth"]
                print("‚úÖ Prediction data loaded successfully")
            else:
                print(f"‚ùå Data file not found: {data_path}")
        except Exception as e:
            print(f"‚ùå Error loading data: {e}")
    
    def calculate_metrics(self):
        """Calculate model performance metrics once"""
        if self.ground_truth is None or self.predictions is None:
            self.metrics = None
            return
        
        try:
            y_true_flat = self.ground_truth.flatten() > 0.5
            y_pred_flat = self.predictions.flatten() > 0.5
            
            acc = accuracy_score(y_true_flat, y_pred_flat)
            f1 = f1_score(y_true_flat, y_pred_flat)
            iou = jaccard_score(y_true_flat, y_pred_flat)
            
            self.metrics = {
                "accuracy": acc,
                "f1_score": f1,
                "iou": iou
            }
            print("‚úÖ Metrics calculated successfully")
        except Exception as e:
            print(f"‚ùå Error calculating metrics: {e}")
            self.metrics = None
    
    def get_metrics(self):
        """Return pre-calculated metrics"""
        return self.metrics
    
    def get_sample_data(self, index):
        """Get sample data for visualization"""
        if (self.ground_truth is None or self.predictions is None or 
            index >= len(self.predictions)):
            return None
        
        try:
            return {
                "ground_truth": self.ground_truth[index, :, :, 0],
                "prediction": self.predictions[index, :, :, 0],
                "difference": np.abs(self.ground_truth[index, :, :, 0] - self.predictions[index, :, :, 0])
            }
        except Exception as e:
            print(f"‚ùå Error getting sample data: {e}")
            return None
    
    def get_growth_trend(self):
        """Get urban growth trend data"""
        years = [2000, 2005, 2010, 2015, 2020, 2030, 2040]
        growth = [10, 18, 25, 40, 55, 70, 88]
        return years, growth
‚îú‚îÄ‚îÄ utils.py:
import streamlit as st
import jwt

def save_token(token):
    st.session_state["jwt_token"] = token

def get_token():
    return st.session_state.get("jwt_token", None)

def decode_token(token):
    try:
        decoded = jwt.decode(token, options={"verify_signature": False})
        return decoded
    except Exception as e:
        st.error(f"Token error: {e}")
        return None
‚îú‚îÄ‚îÄ temp_token.txt
‚îî‚îÄ‚îÄ pages/
    ‚îú‚îÄ‚îÄ login.py:
import streamlit as st
import sys
import os
import matplotlib.pyplot as plt
import numpy as np
import urllib.parse

# Add current directory to Python path
current_dir = os.path.dirname(__file__)
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from utils import get_token, decode_token

st.set_page_config(page_title="Urban Growth Prediction Dashboard", page_icon="üåÜ", layout="wide")

# Check authentication
token = get_token()
if not token:
    st.error("üîê Please login to access the Dashboard")
    st.stop()

# Decode token to get user info
decoded = decode_token(token)
if not decoded:
    st.error("‚ùå Invalid token. Please login again.")
    st.stop()

# ‚úÖ FIXED: Use new st.query_params instead of deprecated st.experimental_get_query_params
query_params = st.query_params
username_from_url = query_params.get("username", [None])[0]

if username_from_url:
    username = urllib.parse.unquote(username_from_url)
else:
    # Fallback to token username
    username = decoded.get("username", f"User {decoded.get('id', 'Unknown')}")

user_id = decoded.get("id", "Unknown User")

# Initialize session state for model loading
if 'model_loaded' not in st.session_state:
    st.session_state.model_loaded = False
if 'predictor' not in st.session_state:
    st.session_state.predictor = None

# Main Dashboard
st.title("üåÜ Urban Growth Prediction Dashboard")
st.subheader(f"Welcome, {username}! üëã")

st.markdown("""
**Visualize predicted urban expansion over time with advanced pattern recognition using TensorFlow U-Net model.**
""")

# Load Model (only once)
if not st.session_state.model_loaded:
    with st.spinner("üöÄ Loading Prediction Model and Data... This may take a moment..."):
        try:
            from urban_predictor import UrbanGrowthPredictor
            st.session_state.predictor = UrbanGrowthPredictor()
            st.session_state.model_loaded = True
            st.success("‚úÖ Prediction Model loaded successfully!")
        except Exception as e:
            st.error(f"‚ùå Error loading prediction model: {e}")
            st.session_state.predictor = None

# Show content only if model is loaded
if st.session_state.model_loaded and st.session_state.predictor:
    predictor = st.session_state.predictor
    
    # Model Performance Metrics
    st.subheader("üìä Model Performance Metrics")

    metrics = predictor.get_metrics()
    if metrics:
        col1, col2, col3 = st.columns(3)
        with col1:
            st.metric("Accuracy", f"{metrics['accuracy']:.4f}")
        with col2:
            st.metric("F1-Score", f"{metrics['f1_score']:.4f}")
        with col3:
            st.metric("IoU Score", f"{metrics['iou']:.4f}")
    else:
        st.error("‚ùå Could not load model metrics.")

    # Urban Growth Visualization
    st.subheader("üñºÔ∏è Urban Growth Prediction Visualization")

    if predictor.predictions is not None:
        max_index = len(predictor.predictions) - 1
        idx = st.slider("Select Sample Index", 0, max_index, 0, 
                       help="Select different urban area samples to visualize predictions")
        
        sample_data = predictor.get_sample_data(idx)
        if sample_data:
            col1, col2, col3 = st.columns(3)
            
            with col1:
                fig1, ax1 = plt.subplots(figsize=(4, 4))
                ax1.imshow(sample_data["ground_truth"], cmap='viridis')
                ax1.set_title("Ground Truth")
                ax1.axis('off')
                st.pyplot(fig1)
            
            with col2:
                fig2, ax2 = plt.subplots(figsize=(4, 4))
                ax2.imshow(sample_data["prediction"], cmap='plasma')
                ax2.set_title("Model Prediction")
                ax2.axis('off')
                st.pyplot(fig2)
            
            with col3:
                fig3, ax3 = plt.subplots(figsize=(4, 4))
                ax3.imshow(sample_data["difference"], cmap='coolwarm')
                ax3.set_title("Difference Map")
                ax3.axis('off')
                st.pyplot(fig3)
            plt.close('all')
    else:
        st.warning("‚ö†Ô∏è No prediction data available.")

    # Urban Growth Trend Chart
    st.subheader("üìà Urban Growth Projection Over Time")

    years, growth = predictor.get_growth_trend()

    fig, ax = plt.subplots(figsize=(10, 6))
    ax.plot(years, growth, marker="o", linewidth=2.5, markersize=8, color='#2563eb')
    ax.fill_between(years, growth, alpha=0.3, color='#2563eb')
    ax.set_xlabel("Year", fontsize=12, fontweight='bold')
    ax.set_ylabel("Urban Growth (%)", fontsize=12, fontweight='bold')
    ax.set_title("Predicted Urban Growth Trend (2000-2040)", fontsize=14, fontweight='bold')
    ax.grid(True, alpha=0.3)
    ax.set_facecolor('#f8fafc')

    st.pyplot(fig)
    plt.close(fig)

else:
    st.warning("‚è≥ Model is still loading... Please wait or refresh the page.")

# Model Information
st.subheader("ü§ñ Model Information")

st.markdown("""
**Model Architecture:** U-Net (Convolutional Neural Network)  
**Training Data:** Satellite imagery and urban growth patterns  
**Purpose:** Predict urban expansion and land use changes  
**Input:** Multi-temporal urban data  
**Output:** Probability maps of urban growth  
**Applications:** Urban planning, environmental monitoring, infrastructure development
""")

# Quick Stats
st.subheader("üöÄ Quick Stats")

col1, col2, col3, col4 = st.columns(4)

with col1:
    st.metric("Cities Analyzed", "24", "12 cities")
with col2:
    st.metric("Data Points", "1.2M", "100K new")
with col3:
    st.metric("Accuracy", "89%", "2% improved")
with col4:
    st.metric("Predictions", "50K", "5K today")

# Refresh button
if st.button("üîÑ Refresh Data"):
    st.session_state.model_loaded = False
    st.session_state.predictor = None
    st.rerun()

# Sidebar logout
st.sidebar.markdown("---")
if st.sidebar.button("üö™ Logout", use_container_width=True):
    st.session_state.clear()
    st.success("Logged out successfully!")
    st.rerun()
    ‚îú‚îÄ‚îÄ register.py:
import streamlit as st
import requests
import sys
import os

# Add current directory to Python path
current_dir = os.path.dirname(__file__)
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from utils import get_token

st.set_page_config(page_title="Register", page_icon="üìù", layout="centered")

# Check if already logged in
token = get_token()
if token:
    st.success("‚úÖ You are already logged in!")
    if st.button("Go to Dashboard"):
        st.switch_page("pages/dashboard.py")
    st.stop()

st.title("üìù Create Dashboard Account")

username = st.text_input("üë§ Choose Username", placeholder="Enter a username")
password = st.text_input("üîí Create Password", type="password", placeholder="Enter a password (min. 6 characters)")
confirm_password = st.text_input("üîí Confirm Password", type="password", placeholder="Re-enter your password")

if st.button("üöÄ Create Account", type="primary", use_container_width=True):
    # Validation
    if not username or not password:
        st.error("‚ùå Please enter both username and password")
    elif password != confirm_password:
        st.error("‚ùå Passwords do not match")
    elif len(password) < 6:
        st.error("‚ùå Password must be at least 6 characters long")
    else:
        try:
            with st.spinner("Creating account..."):
                response = requests.post(
                    "http://localhost:5000/api/users/register",
                    json={"username": username, "password": password},
                    timeout=10
                )

            if response.status_code == 201:
                st.success("‚úÖ Registration successful! Please login with your new account.")
                st.balloons()
                st.markdown("---")
                if st.button("üîê Login Now", use_container_width=True):
                    st.switch_page("pages/login.py")
            else:
                error_msg = response.json().get('message', 'Registration failed')
                st.error(f"‚ùå {error_msg}")
                
        except requests.exceptions.ConnectionError:
            st.error("‚ùå Cannot connect to server. Please ensure the backend is running on http://localhost:5000")
        except Exception as e:
            st.error(f"‚ùå An error occurred: {e}")

# Login link
st.markdown("---")
st.markdown("Already have an account? [Login here](Login)")
    ‚îî‚îÄ‚îÄ dashboard.py:
import streamlit as st
import sys
import os
import matplotlib.pyplot as plt
import numpy as np
import urllib.parse

# Add current directory to Python path
current_dir = os.path.dirname(__file__)
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from utils import get_token, decode_token

st.set_page_config(page_title="Urban Growth Prediction Dashboard", page_icon="üåÜ", layout="wide")

# Check authentication
token = get_token()
if not token:
    st.error("üîê Please login to access the Dashboard")
    st.stop()

# Decode token to get user info
decoded = decode_token(token)
if not decoded:
    st.error("‚ùå Invalid token. Please login again.")
    st.stop()

# ‚úÖ FIXED: Use new st.query_params instead of deprecated st.experimental_get_query_params
query_params = st.query_params
username_from_url = query_params.get("username", [None])[0]

if username_from_url:
    username = urllib.parse.unquote(username_from_url)
else:
    # Fallback to token username
    username = decoded.get("username", f"User {decoded.get('id', 'Unknown')}")

user_id = decoded.get("id", "Unknown User")

# Initialize session state for model loading
if 'model_loaded' not in st.session_state:
    st.session_state.model_loaded = False
if 'predictor' not in st.session_state:
    st.session_state.predictor = None

# Main Dashboard
st.title("üåÜ Urban Growth Prediction Dashboard")
st.subheader(f"Welcome, {username}! üëã")

st.markdown("""
**Visualize predicted urban expansion over time with advanced pattern recognition using TensorFlow U-Net model.**
""")

# Load Model (only once)
if not st.session_state.model_loaded:
    with st.spinner("üöÄ Loading Prediction Model and Data... This may take a moment..."):
        try:
            from urban_predictor import UrbanGrowthPredictor
            st.session_state.predictor = UrbanGrowthPredictor()
            st.session_state.model_loaded = True
            st.success("‚úÖ Prediction Model loaded successfully!")
        except Exception as e:
            st.error(f"‚ùå Error loading prediction model: {e}")
            st.session_state.predictor = None

# Show content only if model is loaded
if st.session_state.model_loaded and st.session_state.predictor:
    predictor = st.session_state.predictor
    
    # Model Performance Metrics
    st.subheader("üìä Model Performance Metrics")

    metrics = predictor.get_metrics()
    if metrics:
        col1, col2, col3 = st.columns(3)
        with col1:
            st.metric("Accuracy", f"{metrics['accuracy']:.4f}")
        with col2:
            st.metric("F1-Score", f"{metrics['f1_score']:.4f}")
        with col3:
            st.metric("IoU Score", f"{metrics['iou']:.4f}")
    else:
        st.error("‚ùå Could not load model metrics.")

    # Urban Growth Visualization
    st.subheader("üñºÔ∏è Urban Growth Prediction Visualization")

    if predictor.predictions is not None:
        max_index = len(predictor.predictions) - 1
        idx = st.slider("Select Sample Index", 0, max_index, 0, 
                       help="Select different urban area samples to visualize predictions")
        
        sample_data = predictor.get_sample_data(idx)
        if sample_data:
            col1, col2, col3 = st.columns(3)
            
            with col1:
                fig1, ax1 = plt.subplots(figsize=(4, 4))
                ax1.imshow(sample_data["ground_truth"], cmap='viridis')
                ax1.set_title("Ground Truth")
                ax1.axis('off')
                st.pyplot(fig1)
            
            with col2:
                fig2, ax2 = plt.subplots(figsize=(4, 4))
                ax2.imshow(sample_data["prediction"], cmap='plasma')
                ax2.set_title("Model Prediction")
                ax2.axis('off')
                st.pyplot(fig2)
            
            with col3:
                fig3, ax3 = plt.subplots(figsize=(4, 4))
                ax3.imshow(sample_data["difference"], cmap='coolwarm')
                ax3.set_title("Difference Map")
                ax3.axis('off')
                st.pyplot(fig3)
            plt.close('all')
    else:
        st.warning("‚ö†Ô∏è No prediction data available.")

    # Urban Growth Trend Chart
    st.subheader("üìà Urban Growth Projection Over Time")

    years, growth = predictor.get_growth_trend()

    fig, ax = plt.subplots(figsize=(10, 6))
    ax.plot(years, growth, marker="o", linewidth=2.5, markersize=8, color='#2563eb')
    ax.fill_between(years, growth, alpha=0.3, color='#2563eb')
    ax.set_xlabel("Year", fontsize=12, fontweight='bold')
    ax.set_ylabel("Urban Growth (%)", fontsize=12, fontweight='bold')
    ax.set_title("Predicted Urban Growth Trend (2000-2040)", fontsize=14, fontweight='bold')
    ax.grid(True, alpha=0.3)
    ax.set_facecolor('#f8fafc')

    st.pyplot(fig)
    plt.close(fig)

else:
    st.warning("‚è≥ Model is still loading... Please wait or refresh the page.")

# Model Information
st.subheader("ü§ñ Model Information")

st.markdown("""
**Model Architecture:** U-Net (Convolutional Neural Network)  
**Training Data:** Satellite imagery and urban growth patterns  
**Purpose:** Predict urban expansion and land use changes  
**Input:** Multi-temporal urban data  
**Output:** Probability maps of urban growth  
**Applications:** Urban planning, environmental monitoring, infrastructure development
""")

# Quick Stats
st.subheader("üöÄ Quick Stats")

col1, col2, col3, col4 = st.columns(4)

with col1:
    st.metric("Cities Analyzed", "24", "12 cities")
with col2:
    st.metric("Data Points", "1.2M", "100K new")
with col3:
    st.metric("Accuracy", "89%", "2% improved")
with col4:
    st.metric("Predictions", "50K", "5K today")

# Refresh button
if st.button("üîÑ Refresh Data"):
    st.session_state.model_loaded = False
    st.session_state.predictor = None
    st.rerun()

# Sidebar logout
st.sidebar.markdown("---")
if st.sidebar.button("üö™ Logout", use_container_width=True):
    st.session_state.clear()
    st.success("Logged out successfully!")
    st.rerun()